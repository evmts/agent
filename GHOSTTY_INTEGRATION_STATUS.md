# Ghostty Terminal Integration Status

## Summary

This document outlines the current status of integrating Ghostty terminal emulator into the Plue project.

## What Was Done

1. **Added Ghostty as a Zig dependency** in `build.zig.zon`:
   ```zig
   .ghostty = .{
       .url = "https://github.com/ghostty-org/ghostty/archive/b46673e63151f495c973d3043bf20612f80deda0.tar.gz",
       .hash = "ghostty-1.1.4-5UdBC49Q9QIhEpOaAYni2oEs7vFlVUQ_chpVl9VFAJQM",
   },
   ```

2. **Created wrapper module** `src/ghostty_terminal.zig` that:
   - Defines the C API interface that Ghostty exposes
   - Provides stub implementations with detailed logging
   - Documents the integration blockers

3. **Updated build configuration** in `build.zig` to:
   - Fetch the Ghostty dependency
   - Create a ghostty_terminal module and library
   - Link it with the main libplue library

4. **Created Swift integration** in `Sources/plue/GhosttyTerminalView.swift`:
   - SwiftUI view that would display the terminal
   - Calls the Ghostty C API functions
   - Currently shows placeholder UI

5. **Updated FFI headers** in `include/libplue.h` with Ghostty function declarations

## Current Blockers

### Missing Dependencies
Ghostty's `main_c.zig` requires several modules that are not available when building it standalone:
- `objc` - Objective-C bindings for macOS
- `cimgui` - Dear ImGui C bindings
- `ziglyph` - Unicode handling library
- `macos` - macOS-specific functionality
- `build_options` - Generated by Ghostty's build system

### Build System Integration
Ghostty is designed as a complete application with its own complex build system. To properly integrate it, we would need to either:
1. Include all of Ghostty's dependencies in our project
2. Build Ghostty separately and link to the resulting library
3. Extract only the terminal emulation core from Ghostty

## Next Steps

### Option 1: Nix Integration (RECOMMENDED)
We've already set up the Nix configuration to handle all of Ghostty's dependencies:
1. Install Nix with flakes enabled
2. Run `nix develop` to enter the development environment
3. Build with `zig build` - Ghostty library will be automatically available
4. See `GHOSTTY_NIX_INTEGRATION.md` for detailed instructions

### Option 2: Full Integration
1. Fork Ghostty and create a library-friendly version
2. Include all required dependencies
3. Modify Ghostty's build.zig to expose it as a reusable module

### Option 3: Subprocess Approach
1. Build Ghostty as a separate executable
2. Embed it as a subprocess with IPC communication
3. Use Ghostty's embed protocol for integration

### Option 4: Minimal Extraction
1. Identify the core terminal emulation code in Ghostty
2. Extract only the necessary parts without UI dependencies
3. Create a minimal terminal emulator module

## Current State

The project builds successfully with stub implementations. The terminal integration points are clearly defined and ready to be connected once the Ghostty dependency issues are resolved.

To test the current integration:
```bash
zig build
./zig-out/bin/plue  # Or however you run the app
```

The terminal view will show a placeholder indicating that Ghostty integration is pending.